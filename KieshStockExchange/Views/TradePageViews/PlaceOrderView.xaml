<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:views="clr-namespace:KieshStockExchange.Views.OtherViews"
             x:Class="KieshStockExchange.Views.TradePageViews.PlaceOrderView">

    <VerticalStackLayout Spacing="15" Padding="15" WidthRequest="300">

        <!-- BUY | SELL Segmented -->
        <views:SegmentedTabView
            SelectedIndex="{Binding SelectedSideIndex}"
            SelectedButtonStyle="{StaticResource SelectedSegmentButtonStyle}"
            UnselectedButtonStyle="{StaticResource UnselectedSegmentButtonStyle}">
            <views:SegmentedTabView.Tabs>
                <views:SegmentedTabItem Header="Buy" />
                <views:SegmentedTabItem Header="Sell" />
            </views:SegmentedTabView.Tabs>
        </views:SegmentedTabView>

        <!-- MARKET | LIMIT Segmented -->
        <views:SegmentedTabView
            SelectedIndex="{Binding SelectedTypeIndex}"
            SelectedButtonStyle="{StaticResource SelectedSegmentButtonStyle}"
            UnselectedButtonStyle="{StaticResource UnselectedSegmentButtonStyle}">
            <views:SegmentedTabView.Tabs>
                <views:SegmentedTabItem Header="Market" />
                <views:SegmentedTabItem Header="Limit" />
            </views:SegmentedTabView.Tabs>
        </views:SegmentedTabView>

        <!-- Asset Display -->
        <Grid RowDefinitions="Auto,*" ColumnSpacing="10" >
            <Label Text="{Binding AssetText}" Style="{StaticResource StockPlacerLabel}" />
            <Label Grid.Row="1" Text="{Binding AvailableAssetsText}" Style="{StaticResource ValueLabel}" />
        </Grid>

        <!-- MARKET pane -->
        <Grid x:Name="MarketPane" IsVisible="{Binding IsMarketSelected}"
              RowDefinitions="Auto,Auto" Margin="0,15,0,0">
            <!-- Slippage -->
            <Label Grid.Row="0" Text="Slippage guard" Style="{StaticResource StockPlacerLabel}" />
            <Grid Grid.Row="1" ColumnDefinitions="Auto,Auto,Auto,*,Auto">
                <Label Grid.Column="0" Text="None" VerticalOptions="Center" />
                <CheckBox Grid.Column="1" IsChecked="{Binding NoSlippageGuard}" />
                <Label Grid.Column="2" Text="Â±" VerticalOptions="Center" />
                <Slider Grid.Column="3" Minimum="0" Maximum="0.05"
                        Value="{Binding SlippagePrc, Mode=TwoWay}" VerticalOptions="Center" />
                <Label Grid.Column="4" VerticalOptions="Center"
                       Text="{Binding SlippagePrc, StringFormat='{}{0:P2}'}" />
            </Grid>
        </Grid>

        <!-- LIMIT pane -->
        <Grid x:Name="LimitPane" IsVisible="{Binding IsLimitSelected}"
               ColumnDefinitions="Auto,*" Margin="0,15,0,0" ColumnSpacing="8">
            <!-- Limit Price entry -->
            <Label Grid.Column="0" Text="Limit price" Style="{StaticResource StockPlacerLabel}" />
            <Entry Grid.Column="1" Style="{StaticResource StockPlacerEntry}"
                   Text="{Binding LimitPriceString, Mode=TwoWay}" Placeholder="{Binding Selected.CurrentPriceDisplay}" />
        </Grid>

        <!-- Quantity, TotalValue and Submit -->
        <Grid RowDefinitions="Auto,Auto,Auto" ColumnDefinitions="Auto,*" Margin="0,15,0,0" RowSpacing="12" ColumnSpacing="8">
            <!-- Quantity label-->
            <Label Grid.Row="0" Grid.Column="0" Text="Quantity" Style="{StaticResource StockPlacerLabel}" />
            <Entry Grid.Row="0" Grid.Column="1" Keyboard="Numeric" Text="{Binding QuantityString, Mode=TwoWay}" />
            
            <!-- Total ordervalue label-->
            <Label Grid.Row="1" Grid.Column="0" Text="Total" Style="{StaticResource StockPlacerLabel}" />
            <Label Grid.Row="1" Grid.Column="1" Text="{Binding OrderValue}" Style="{StaticResource ValueLabel}" />

            <!-- Submit button -->
            <Button Grid.Row="2" Grid.ColumnSpan="2" Text="{Binding SubmitButtonText}"
                    Style="{StaticResource StockPlacerButton}"  BackgroundColor="{Binding SubmitButtonColor}" 
                    Command="{Binding PlaceOrderCommand}" />
        </Grid>

    </VerticalStackLayout>
</ContentView>
