<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:views="clr-namespace:KieshStockExchange.Views.OtherViews"
             x:Class="KieshStockExchange.Views.TradePageViews.PlaceOrderView">

    <VerticalStackLayout Spacing="15" Padding="15">

        <!-- BUY | SELL Segmented -->
        <views:SegmentedTabView
            SelectedIndex="{Binding SelectedSideIndex}"
            SelectedButtonStyle="{StaticResource SelectedSegmentButtonStyle}"
            UnselectedButtonStyle="{StaticResource UnselectedSegmentButtonStyle}">
            <views:SegmentedTabView.Tabs>
                <views:SegmentedTabItem Header="Buy" />
                <views:SegmentedTabItem Header="Sell" />
            </views:SegmentedTabView.Tabs>
        </views:SegmentedTabView>

        <!-- MARKET | LIMIT Segmented -->
        <views:SegmentedTabView
            SelectedIndex="{Binding SelectedOrderTypeIndex}"
            SelectedButtonStyle="{StaticResource SelectedSegmentButtonStyle}"
            UnselectedButtonStyle="{StaticResource UnselectedSegmentButtonStyle}">
            <views:SegmentedTabView.Tabs>
                <views:SegmentedTabItem Header="Market" />
                <views:SegmentedTabItem Header="Limit" />
            </views:SegmentedTabView.Tabs>
        </views:SegmentedTabView>

        <!-- Dynamic Content -->
        <ContentView>
            <ContentView.Triggers>
                <!-- MARKET Content -->
                <DataTrigger TargetType="ContentView"
                             Binding="{Binding SelectedOrderTypeIndex}"
                             Value="0">
                    <Setter Property="Content">
                        <Setter.Value>
                            <VerticalStackLayout Spacing="10">
                                <Label Text="Market Price:" FontAttributes="Bold"/>
                                <Label Text="{Binding CurrentMarketPrice, StringFormat='{}{0:C}'}"/>

                                <Label Text="Slippage %" FontAttributes="Bold"/>
                                <HorizontalStackLayout>
                                    <Button Text="0.5%" Command="{Binding SetSlippageCommand}" CommandParameter="0.5"/>
                                    <Button Text="1%" Command="{Binding SetSlippageCommand}" CommandParameter="1"/>
                                    <Button Text="2%" Command="{Binding SetSlippageCommand}" CommandParameter="2"/>
                                </HorizontalStackLayout>
                                <Entry Placeholder="Custom %" Text="{Binding SlippagePercent}"/>
                            </VerticalStackLayout>
                        </Setter.Value>
                    </Setter>
                </DataTrigger>

                <!-- LIMIT Content -->
                <DataTrigger TargetType="ContentView"
                             Binding="{Binding SelectedOrderTypeIndex}"
                             Value="1">
                    <Setter Property="Content">
                        <Setter.Value>
                            <VerticalStackLayout Spacing="10">
                                <Label Text="Market Price:" FontAttributes="Bold"/>
                                <Label Text="{Binding CurrentMarketPrice, StringFormat='{}{0:C}'}"/>

                                <Label Text="Limit Price:" FontAttributes="Bold"/>
                                <Entry Placeholder="Enter Limit Price" 
                                       Keyboard="Numeric"
                                       Text="{Binding LimitPrice}"/>
                            </VerticalStackLayout>
                        </Setter.Value>
                    </Setter>
                </DataTrigger>
            </ContentView.Triggers>
        </ContentView>

        <!-- Funds/Assets -->
        <Label Text="{Binding AvailableAssets}" FontAttributes="Bold"/>

        <!-- Quantity -->
        <Entry Placeholder="Quantity" Keyboard="Numeric" 
               Text="{Binding Quantity}" />

        <!-- Percentage Bar -->
        <HorizontalStackLayout Spacing="10" HorizontalOptions="Center">
            <Button Text="0%" Command="{Binding SetQuantityPercentCommand}" CommandParameter="0"/>
            <Button Text="25%" Command="{Binding SetQuantityPercentCommand}" CommandParameter="25"/>
            <Button Text="50%" Command="{Binding SetQuantityPercentCommand}" CommandParameter="50"/>
            <Button Text="75%" Command="{Binding SetQuantityPercentCommand}" CommandParameter="75"/>
            <Button Text="100%" Command="{Binding SetQuantityPercentCommand}" CommandParameter="100"/>
        </HorizontalStackLayout>

        <!-- Order Value -->
        <Label Text="Order Value:" FontAttributes="Bold"/>
        <Entry Text="{Binding OrderValue}" IsReadOnly="True"/>

        <!-- Submit Button -->
        <Button Text="{Binding SubmitButtonText}" 
                BackgroundColor="{Binding SubmitButtonColor}" 
                Command="{Binding PlaceOrderCommand}"
                HeightRequest="50"/>
    </VerticalStackLayout>
</ContentView>
